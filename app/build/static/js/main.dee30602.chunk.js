(this.webpackJsonpwasm_algorithms=this.webpackJsonpwasm_algorithms||[]).push([[0],{13:function(e,n,t){},14:function(e,n,t){},17:function(e,n,t){"use strict";t.r(n);var r=t(0),c=t(1),a=t.n(c),i=t(5),s=t.n(i),u=(t(13),t.p+"static/media/WebAssembly_Logo.1381587b.svg"),l=(t(14),t(2)),o=t.n(l),d=t(4),f=t.n(d),b=t(6),j=t(7),h=t.n(j);function v(e,n,t,r,c,a,i){if(null!==e.current&&null!==n.current&&null!==t.current&&null!==r.current&&null!==c.current&&null!==a.current&&null!==i.current){var s,u,l,o,d=-1,j=1/0,v=0,m=0,g=[],x=0,p=0,O=0;t.current.addEventListener("click",(function(){m=1===m?0:1})),r.current.addEventListener("click",(function(){m=2===m?0:2})),c.current.addEventListener("click",(function(){m=3===m?0:3})),a.current.addEventListener("click",(function(){m=4===m?0:4})),i.current.addEventListener("click",(function(){m=5===m?0:5})),Object(b.a)(f.a.mark((function e(){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return w(),e.next=3,wasm_bindgen(o);case 3:u=e.sent,l=u.__wbindgen_export_0,navigator.mediaDevices.getUserMedia&&navigator.mediaDevices.getUserMedia({video:!0}).then(y).catch((function(){console.log("Something went wrong!")}));case 6:case"end":return e.stop()}}),e)})))()}function w(){var e=window.location.href.split("/");""===e[e.length-1]&&e.pop();var n=window.location.href.replace(e[e.length-1],e[e.length-1]+"/pkg/index_bg.wasm");"/"===n[n.length-1]&&(n=n.slice(0,-1)),o=n}function _(t){var r;if(n.current&&e.current){if(function(e){v%5===0&&(document.querySelector("#fps").innerHTML=(1e3/(e-j)).toFixed(2));(v+=1)>5&&(v=0);j=e}(t),p=n.current.videoWidth,O=n.current.videoHeight,p>0&&e.current&&-1===d)return function(t,r){if(n.current&&e.current){e.current.width=t,e.current.height=r;var c=t*r*4;return d=u.alloc(c),requestAnimationFrame(_)}}(p,O);if(null===(r=s)||void 0===r||r.drawImage(n.current,0,0,p,O),0===m||!(p>0&&e.current&&s))return requestAnimationFrame(_);var c,a,i=s.getImageData(0,0,p,O);switch(c=i.data.buffer,a=l.buffer,new Uint8Array(a,d,c.byteLength).set(new Uint8Array(c)),m){case 2:for(var o=0;o<g.length;o++)g[o].box_blur(d,p,O,o,navigator.hardwareConcurrency)}}}function k(e){if(!e.data.type)if(e.data.loaded&&x===navigator.hardwareConcurrency-1)x=0,_((new Date).getTime());else if(e.data.loaded)x+=1;else if(e.data.workerFinished&&x===navigator.hardwareConcurrency-1){var n;console.log("workers are all finished"),x=0;var t=new Uint8ClampedArray(l.buffer,d,p*O*4).slice(0),r=new ImageData(t,p,O);null===(n=s)||void 0===n||n.putImageData(r,0,0),requestAnimationFrame(_)}else e.data.workerFinished&&(x+=1)}function y(t){null!==e.current&&(s=e.current.getContext("2d")),n.current&&(n.current.srcObject=t),function(){for(var e=0;e<navigator.hardwareConcurrency;e++){var n=h()();n.addEventListener("message",k),n.loadWasm(o),g.push(n)}}()}}var m=function(){var e=Object(c.useRef)(null),n=Object(c.useRef)(null),t=Object(c.useRef)(null),a=Object(c.useRef)(null),i=Object(c.useRef)(null),s=Object(c.useRef)(null),u=Object(c.useRef)(null);return Object(c.useEffect)((function(){return v(e,n,t,a,i,s,u)}),[t,n,e]),Object(r.jsxs)("div",{className:o.a.flex,children:[Object(r.jsx)("div",{className:o.a.sideDiv,children:Object(r.jsxs)("ul",{className:o.a.buttonList,children:[Object(r.jsx)("li",{children:Object(r.jsx)("button",{ref:t,children:"Sobel Edge Detection"})}),Object(r.jsx)("li",{children:Object(r.jsx)("button",{ref:a,children:"Box Blur"})}),Object(r.jsx)("li",{children:Object(r.jsx)("button",{ref:i,children:"Sharpen"})}),Object(r.jsx)("li",{children:Object(r.jsx)("button",{ref:s,children:"Emboss"})}),Object(r.jsx)("li",{children:Object(r.jsx)("button",{ref:u,children:"Laplacian"})})]})}),Object(r.jsx)("canvas",{ref:e,children:" "}),Object(r.jsx)("video",{className:o.a.hide,autoPlay:!0,ref:n}),Object(r.jsx)("div",{className:o.a.sideDiv})]})};var g=function(){return Object(r.jsx)("div",{className:"App",children:Object(r.jsxs)("header",{className:"App-header",children:[Object(r.jsx)("img",{src:u,className:"App-logo",alt:"logo"}),Object(r.jsxs)("p",{children:["Cam effects with ",Object(r.jsx)("code",{children:"wasm"})," and ",Object(r.jsx)("code",{children:"rust"})," ",Object(r.jsx)("span",{id:"fps"}),"fps"]}),Object(r.jsx)(m,{})]})})},x=function(e){e&&e instanceof Function&&t.e(3).then(t.bind(null,18)).then((function(n){var t=n.getCLS,r=n.getFID,c=n.getFCP,a=n.getLCP,i=n.getTTFB;t(e),r(e),c(e),a(e),i(e)}))};s.a.render(Object(r.jsx)(a.a.StrictMode,{children:Object(r.jsx)(g,{})}),document.getElementById("root")),x()},2:function(e,n,t){e.exports={hide:"cam_hide__3ykpy",flex:"cam_flex__2nGjf",sideDiv:"cam_sideDiv__2z-E5",buttonList:"cam_buttonList__28TZE"}},7:function(e,n,t){var r=t(16),c=["box_blur","sobel","loadWasm"];e.exports=function(){var e=new Worker(t.p+"bd6347b03758c9d098bd.worker.js",{name:"[hash].worker.js"});return r(e,c),e}}},[[17,1,2]]]);
//# sourceMappingURL=main.dee30602.chunk.js.map