(this.webpackJsonpwasm_algorithms=this.webpackJsonpwasm_algorithms||[]).push([[0],{13:function(e,n,r){},14:function(e,n,r){},17:function(e,n,r){"use strict";r.r(n);var t=r(0),c=r(1),a=r.n(c),i=r(5),s=r.n(i),l=(r(13),r.p+"static/media/WebAssembly_Logo.1381587b.svg"),u=(r(14),r(2)),o=r.n(u),d=r(4),f=r.n(d),b=r(6),j=r(7),h=r.n(j);function m(e,n,r,t,c,a,i,s,l){if(null!==e.current&&null!==n.current&&null!==r.current&&null!==t.current&&null!==c.current&&null!==a.current&&null!==i.current&&null!==s.current&&null!==l.current){var u,o,d,j,m,v=-1,g=1/0,x=0,O=0,p=[],w=0,_=0,y=0,k=navigator.hardwareConcurrency,L=navigator.hardwareConcurrency;c.current.addEventListener("click",(function(){O=1===O?0:1})),a.current.addEventListener("click",(function(){O=2===O?0:2})),i.current.addEventListener("click",(function(){O=3===O?0:3})),s.current.addEventListener("click",(function(){O=4===O?0:4})),l.current.addEventListener("click",(function(){O=5===O?0:5})),e.current.addEventListener("input",(function(e){document.querySelector("#slider-concurrency").innerHTML=e.target.value,k=Number(e.target.value)})),Object(b.a)(f.a.mark((function e(){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return C(),e.next=3,wasm_bindgen(m);case 3:d=e.sent,j=d.__wbindgen_export_0,navigator.mediaDevices.getUserMedia&&navigator.mediaDevices.getUserMedia({video:!0}).then(E).catch((function(){console.log("Something went wrong!")}));case 6:case"end":return e.stop()}}),e)})))()}function C(){var e=window.location.href.split("/");""===e[e.length-1]&&e.pop();var n=window.location.href.replace(e[e.length-1],e[e.length-1]+"/pkg/index_bg.wasm");"/"===n[n.length-1]&&(n=n.slice(0,-1)),m=n}function N(e){var c;if(t.current&&n.current&&r.current){if(function(e){x%5===0&&(document.querySelector("#fps").innerHTML=(1e3/(e-g)).toFixed(2));(x+=1)>5&&(x=0);g=e}(e),_=t.current.videoWidth,y=t.current.videoHeight,_>0&&n.current&&-1===v)return function(e,c){if(t.current&&n.current&&r.current){r.current.width=e,r.current.height=c,n.current.width=e,n.current.height=c;var a=e*c*4;return v=d.alloc(a),requestAnimationFrame(N)}}(_,y);var a;if(null===(c=o)||void 0===c||c.drawImage(t.current,0,0,_,y),0===O||!(_>0&&n.current&&u&&o))return null===(a=u)||void 0===a||a.drawImage(t.current,0,0,_,y),requestAnimationFrame(N);var i,s,l=o.getImageData(0,0,_,y);switch(i=l.data.buffer,s=j.buffer,new Uint8Array(s,v,i.byteLength).set(new Uint8Array(i)),L=k,O){case 1:for(var f=0;f<k;f++)p[f].sobel(v,_,y,f,k);break;case 2:for(var b=0;b<k;b++)p[b].box_blur(v,_,y,b,k);break;case 3:for(var h=0;h<k;h++)p[h].sharpen(v,_,y,h,k);break;case 4:for(var m=0;m<k;m++)p[m].emboss(v,_,y,m,k);break;case 5:for(var w=0;w<k;w++)p[w].laplacian(v,_,y,w,k)}}}function D(e){if(!e.data.type)if(e.data.loaded&&w===L-1)w=0,N((new Date).getTime());else if(e.data.loaded)w+=1;else if(e.data.workerFinished&&w===L-1){var n;w=0;var r=new Uint8ClampedArray(j.buffer,v,_*y*4).slice(0),t=new ImageData(r,_,y);null===(n=u)||void 0===n||n.putImageData(t,0,0),requestAnimationFrame(N)}else e.data.workerFinished&&(w+=1)}function E(e){null!==n.current&&(u=n.current.getContext("2d")),null!==r.current&&(o=r.current.getContext("2d")),t.current&&(t.current.srcObject=e),function(){for(var e=0;e<k;e++){var n=h()();n.addEventListener("message",D),n.loadWasm(m,j),p.push(n)}}()}}var v=function(){var e=Object(c.useRef)(null),n=Object(c.useRef)(null),r=Object(c.useRef)(null),a=Object(c.useRef)(null),i=Object(c.useRef)(null),s=Object(c.useRef)(null),l=Object(c.useRef)(null),u=Object(c.useRef)(null),d=Object(c.useRef)(null);return Object(c.useEffect)((function(){return m(d,e,n,r,a,i,s,l,u)}),[a,r,e]),Object(t.jsxs)(t.Fragment,{children:[Object(t.jsxs)("div",{className:o.a.sliderContainer,children:[Object(t.jsxs)("label",{children:["Concurrency: ",Object(t.jsx)("span",{id:"slider-concurrency",children:navigator.hardwareConcurrency})]}),Object(t.jsx)("input",{ref:d,type:"range",max:navigator.hardwareConcurrency,min:1,className:o.a.slider})]}),Object(t.jsxs)("div",{className:o.a.flex,children:[Object(t.jsx)("div",{className:o.a.sideDiv,children:Object(t.jsxs)("ul",{className:o.a.buttonList,children:[Object(t.jsx)("li",{children:Object(t.jsx)("button",{ref:a,children:"Sobel Edge Detection"})}),Object(t.jsx)("li",{children:Object(t.jsx)("button",{ref:i,children:"Box Blur"})}),Object(t.jsx)("li",{children:Object(t.jsx)("button",{ref:s,children:"Sharpen"})}),Object(t.jsx)("li",{children:Object(t.jsx)("button",{ref:l,children:"Emboss"})}),Object(t.jsx)("li",{children:Object(t.jsx)("button",{ref:u,children:"Laplacian"})})]})}),Object(t.jsx)("canvas",{ref:e,children:" "}),Object(t.jsx)("canvas",{className:o.a.hide,ref:n}),Object(t.jsx)("video",{className:o.a.hide,autoPlay:!0,ref:r}),Object(t.jsx)("div",{className:o.a.sideDiv})]})]})};var g=function(){return Object(t.jsx)("div",{className:"App",children:Object(t.jsxs)("header",{className:"App-header",children:[Object(t.jsx)("img",{src:l,className:"App-logo",alt:"logo"}),Object(t.jsxs)("p",{children:["Cam effects with ",Object(t.jsx)("code",{children:"wasm"})," and ",Object(t.jsx)("code",{children:"rust"})," ",Object(t.jsx)("span",{id:"fps"}),"fps"]}),Object(t.jsx)(v,{})]})})},x=function(e){e&&e instanceof Function&&r.e(3).then(r.bind(null,18)).then((function(n){var r=n.getCLS,t=n.getFID,c=n.getFCP,a=n.getLCP,i=n.getTTFB;r(e),t(e),c(e),a(e),i(e)}))};s.a.render(Object(t.jsx)(a.a.StrictMode,{children:Object(t.jsx)(g,{})}),document.getElementById("root")),x()},2:function(e,n,r){e.exports={hide:"cam_hide__3ofNy",flex:"cam_flex__22L5-",sideDiv:"cam_sideDiv__1_1lG",buttonList:"cam_buttonList__TsgiK",sliderContainer:"cam_sliderContainer__3EaNK",slider:"cam_slider__3jfm3"}},7:function(e,n,r){var t=r(16),c=["box_blur","sobel","sharpen","emboss","laplacian","loadWasm"];e.exports=function(){var e=new Worker(r.p+"96cf4658b9e6d69be773.worker.js",{name:"[hash].worker.js"});return t(e,c),e}}},[[17,1,2]]]);
//# sourceMappingURL=main.ad857c14.chunk.js.map